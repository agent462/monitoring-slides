<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>All the monitoring</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" />

  <script type="text/javascript" src="./js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  
    
      <script type="text/javascript" src="./js/sh_lang/sh_json.min.js"></script>
    
  

  
    <link rel="stylesheet" href="./file/style.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
    <tr><td class="key">P</td><td>toggle pause</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content center" ref="intro/01_slide/1">
<h1>All the Monitoring</h1>

<p><span id="title">
<img src="./file/intro/../img/intro.jpg" alt="letter">
</img></span>

<h2>Bryan Brandau</h2>

<h3>@agent462</h3>

<h3>Sr. Manager of Operations, bestbuy.com</h3>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets incremental" ref="intro/01_slide/2">
<h1>NO</h1>

<ul>
<li>I'm not here to bash any tool</li>
<li>I can if you want me to :)
## [I love to troll]</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets incremental" ref="intro/01_slide/3">
<h1>The Goal</h1>

<h2>An open source monitoring system.</h2>

<h2>Aims to be simple, malleable, and scalable.</h2>

<ul>
<li><p>Compose a system - your requirements.</p></li>
<li><p>Don't tie yourself to a single monolithic piece of software or service.</p></li>
</ul>
</div>
</div><div class="slide" data-transition="growX"><div class="content center" ref="intro/01_slide/4">
<h1>Choices</h1>

<p>Nagios
* Zabbix
* Ganglia
* Munin
* Zenoss
* Openmms
* OpenTSDB
* Icinga
* Graylog2
* Hyperic
* Diamond
* Shinken
* Cacti
* New Relic
* Loggly
* Stat Hat
* Ops Genie
* Twilio
* HP Openview</p>

<h1>100's of other Enterprise products</h1>
</div>
</div><div class="slide" data-transition="fadeZoom"><div class="content smaller incremental" ref="intro/01_slide/5">
<h1>Okay, I left out a few but what do we need</h1>

<ul>
<li>System metrics (CPU, memory, df, iostat, etc)</li>
<li>Application metrics (error counts, latency, service timings)</li>
<li>Log files</li>
<li>Synthetic Monitoring (transactional)</li>
<li>Rates, aggregates and state</li>
<li>Graph everything</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="intro/02_slide/1">
<h1>Revisit the guiding principles</h1>

<h2>Aims to be simple, malleable, and scalable.</h2>

<ul>
<li><p>Focus on open source.</p></li>
<li><p>Compose a system - your requirements.</p></li>
<li><p>Don't tie yourself to a single monolithic piece of software or service.</p></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="intro/02_slide/2">
<h2>Sensu</h2>

<h2>Graphite</h2>

<h2>Collectd</h2>

<h2>Logstash</h2>

<ul>
<li>I lied, slightly.</li>
<li>if you have $, buy Splunk</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content center" ref="intro/02_slide/3">
<p><img src="./file/intro/../img/lets_do_this.png" alt="letter"/>
</p>
</div>
</div><div class="slide" data-transition="scrollLeft"><div class="content center" ref="sensu/01_slide/1">
<h1>Sensu</h1>

<h2>A monitoring router and framework</h2>

<p><img src="./file/sensu/../img/sensu_fan.png" alt="sensu"/>
</p>
</div>
</div><div class="slide" data-transition="none"><div class="content center incremental" ref="sensu/01_slide/2">
<h1>Only cares about bad state</h1>

<p><img src="./file/sensu/../img/sensu-admin.png" alt="sensu"/>
</p>
</div>
</div><div class="slide" data-transition="none"><div class="content center incremental" ref="sensu/01_slide/3">
<h1>VS Information overload</h1>

<p><img src="./file/sensu/../img/nagios.jpg" alt="nagios"/>
</p>
</div>
</div><div class="slide" data-transition="none"><div class="content center incremental" ref="sensu/01_slide/4">
<h1>Or this</h1>
</div>
</div><div class="slide" data-transition="none"><div class="content center incremental" ref="sensu/01_slide/5">
<p><img src="./file/sensu/../img/nagios-objects.png" alt="nagios"/>
</p>
</div>
</div><div class="slide" data-transition="none"><div class="content center incremental" ref="sensu/01_slide/6">
<p><img src="./file/sensu/../img/sensu-objects.png" alt="nagios"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content" ref="sensu/01_slide/7">
<h1>Check</h1>

<h2>Result</h2>

<h2>V</h2>

<h2>Event</h2>

<h1>Handler</h1>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets" ref="sensu/01_slide/8">
<h1>Check</h1>

<ul>
<li><p>Outputs data* to STDOUT or STDERR.</p></li>
<li><p>Uses exit status to indicate severity.</p></li>
</ul>

<h2>0: OK</h2>

<h2>1: WARNING</h2>

<h2>2: CRITICAL</h2>

<h2>&gt;= 3: UNKNOWN or CUSTOM</h2>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content code smaller" ref="sensu/01_slide/9">
<pre class="sh_json"><code>{
  "checks": {
    "check_disk": {
      "command": "check-disk.rb -w 85 -c 95",
      "handlers": [
        "bby"
      ],
      "standalone": true,
      "interval": 30,
      "refresh": 1800,
      "occurrences": 2
    }
  }
}</code></pre>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content code smallcode" ref="sensu/01_slide/10">
<pre class="sh_json"><code>{
  "checks": {
    "chef-process": {
      "command": "PATH=$PATH:/usr/lib64/nagios/plugins check_procs -C chef-client -c 1:9",
      "handlers": [
        "bby"
      ],
      "standalone": true,
      "interval": 60,
      "refresh": 1800,
      "occurrences": 2
    }
  }
}</code></pre>
</div>
</div><div class="slide" data-transition="scrollLeft"><div class="content center bullets" ref="sensu/01_slide/11">
<ul>
<li>Every check result is inspected.</li>
</ul>

<h2>Non-zero exit status?</h2>

<h2>First zero exit status in a series?</h2>

<h2>Marked as a metric?</h2>

<h2>V</h2>

<h1>Event</h1>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="sensu/01_slide/12">
<h1>Event Data</h1>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content code tinycode smaller" ref="sensu/01_slide/13">
<pre><code>{
  "client": {
    "name": "i-c903caf4",
    "address": "107.23.172.32",
    "subscriptions": [
      "web"
    ],
    "platform_version": "6.4",
    "chef_version": "11.4.0",
    "local_ipv4": "10.2.13.107",
    "placement": "us-east-1a",
  },
  check: {
    name: "frontend_http",
    command: "check_http -u http://example.com",
    subscribers: ["application"],
    handlers: ["pagerduty"],
    interval: 60,
    output: "HTTP/1.1 503 Service Temporarily Unavailable",
    status: 2,
    history: [0, 2],
    flapping: false,
    issued: 1364274239,
    executed: 1364274240
  },
  occurrences: 1,
  action: "create"
}</code></pre>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets" ref="sensu/02_slide/1">
<h1>Handler</h1>

<ul>
<li><p>Takes action on event data.</p></li>
<li><p>Several types: execute a script, open a socket ...</p></li>
</ul>

<h2>[Pipe, TCP, UDP, AMQP, Set]</h2>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content code medium" ref="sensu/02_slide/2">
<pre><code>{
  "handlers": {
    "awsdecommission": {
      "type": "pipe",
      "command": "/etc/sensu/handlers/awsdecomm.rb",
      "severities": [
        "ok",
        "warning",
        "critical"
      ]
    }
  }
}</code></pre>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content small center" ref="sensu/02_slide/3">
<h1>The good</h1>

<ul>
<li><p>Keepalives</p></li>
<li><p>Compatible with nagios plugins</p></li>
<li><p>It can utilize bash, ruby, python, etc (anything)</p></li>
<li><p>Deep merging of configuration files</p></li>
<li><p>Groups/Sets</p></li>
<li><p>Aggregates</p></li>
<li><p>Community Plugins</p></li>
</ul>
</div>
</div><div class="slide" data-transition="growY"><div class="content center" ref="sensu/03_slide/1">
<p><img src="./file/sensu/../img/check.png" alt="sensu"/>
</p>
</div>
</div><div class="slide" data-transition="growY"><div class="content center" ref="sensu/03_slide/2">
<p><img src="./file/sensu/../img/handler.png" alt="sensu"/>
</p>
</div>
</div><div class="slide" data-transition="growY"><div class="content center" ref="sensu/03_slide/3">
<p><img src="./file/sensu/../img/sensu-cli.png" alt="sensu"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content" ref="collectd/01_slide/1">
<h1>Collectd</h1>

<h2>[The system statistics collection daemon]</h2>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="collectd/01_slide/2">
<ul>
<li><p>Written in C</p></li>
<li><p>Over 90 plugins</p></li>
<li><p>Get all your system metrics here</p></li>
<li><p>Outputs to graphite</p></li>
<li><p>Easy setup</p></li>
<li><p>Each plugin can run at different intervals</p></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content code small" ref="collectd/01_slide/3">
<pre><code>[bbrandau@ip-10-2-12-10 plugins]# cat memcached.conf
LoadPlugin "memcached"

&lt;Plugin "memcached"&gt;
  Host  "127.0.0.1"
  Port  "11211"
&lt;/Plugin&gt;</code></pre>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="graphite/01_slide/1">
<h1>Graphite</h1>

<h2>scalable realtime graphing</h2>

<p><img src="./file/graphite/../img/graphite.png" alt="graphite"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="graphite/01_slide/2">
<p><img src="./file/graphite/../img/charts.png" alt="graphite"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="graphite/01_slide/3">
<ul>
<li><p>Time series database (whisper)</p></li>
<li><p>Powerful rendering engine</p></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content small bullets" ref="graphite/01_slide/4">
<h1>RRD vs Whisper</h1>

<ul>
<li><p>RRD can not take updates to a time-slot prior to its most recent update</p></li>
<li><p>RRD was not designed with irregular updates in mind</p></li>
<li><p>Whisper is slower; hundreds of microseconds (10^-4) which means less than a millisecond</p></li>
</ul>
</div>
</div><div class="slide" data-transition="growX"><div class="content smaller" ref="graphite/01_slide/5">
<h1>Render URL API</h1>

<h2>http://graphite/render/?width=960&amp;height=505&amp;target=collectd.graphite.i-ac229dw1.cpu-0.cpu-idle</h2>

<ul>
<li>width=960</li>
<li>height=505</li>
<li>target=collectd.graphite.i-ac229dw1.cpu-0.cpu-idle</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content center small bullets incremental" ref="graphite/01_slide/6">
<h1>That's beginner stuff, how about</h1>

<ul>
<li><p>derivative()</p></li>
<li><p>drawAsInfinite()</p></li>
<li><p>highestAverage()</p></li>
<li><p>holtWintersAberration()</p></li>
<li><p>logarithm()</p></li>
<li><p>mostDeviant()</p></li>
<li><p>100's of ways to manipulate the data and graphs</p></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content center" ref="graphite/01_slide/7">
<p><img src="./file/graphite/../img/holt.png" alt="graphite"/>
</p>
</div>
</div><div class="slide" data-transition="none">
  <div class="content center" ref="graphite/02_slide/1">
<h1>How do you get data in?</h1>

<h2><metric> <metric> <metric/>

<ul>
<li>Open Socket</li>
<li>echo sensu.instance.checkdisk 1 1364961937</li>
<li>Close Socket</li>
</ul>
</metric>
</metric>
</h2></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="graphite/02_slide/2">
<p><img src="./file/graphite/../img/graphite-web.png" alt="graphite"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content" ref="log/01_slide/1">
<h1>Logging</h1>

<h2>Splunk is the best tool but costs real $ or 500MB per day free</h2>

<h2>Logstash is a great free alternative</h2>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="log/01_slide/2">
<h1>Logstash</h1>

<p>Open Source Log Management
<img src="./file/log/../img/logstash.png" alt="logstash"/>

<h2>[ Ship Logs - Parse - Index - Search ]</h2>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="log/01_slide/3">
<h1>Get Kibana</h1>

<ul>
<li>Search</li>
<li>Graph</li>
<li>Score (Trend/Avg/Score)</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="log/01_slide/4">
<p><img src="./file/log/../img/logstash-web.png" alt="logstash"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="log/01_slide/5">
<h1>Logster</h1>

<ul>
<li><p>Generate metrics from log files</p></li>
<li><p>Parse log files but maintains cursor</p></li>
<li><p>Graphite, Ganglia or Amazon CloudWatch</p></li>
<li><p>Troll your logs</p></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content small" ref="log/01_slide/6">
<h1>Logs can be the heart and soul of metrics</h1>

<ul>
<li>This should be your richest source of data</li>
<li>If not, you're probably doing it wrong</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content small" ref="log/02_slide/1">
<h1>How to log effectively</h1>

<ul>
<li>Time Formats

<ul>
<li>Time formats ISO 8601</li>
<li>Time at the beginning of the line</li>
<li>YYYY-MM-DDThh:mm:ss.fffz where fff represents milliseconds</li>
</ul></li>
<li>Unique Identifiers

<ul>
<li>Correlate to user</li>
<li>Include non PII user data</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content small" ref="log/02_slide/2">
<ul>
<li><p>Categorization</p>

<ul>
<li>Multiple levels (INFO, WARN, etc)</li>
<li>Assign priority (P1, P2, etc)</li>
</ul></li>
<li><p>Profiling Data</p>

<ul>
<li>Record Timings for Model, View, Controller processing times.</li>
<li>Record Timings for external dependency calls (API, etc)</li>
<li>Is host1 processing X in the same amount of time as host2</li>
<li>Has the render for X increased after this deployment</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content smaller code" ref="log/02_slide/3">
<h1>Log Structure</h1>

<pre><code>  time=2012-03-05T16:45:01:999Z ip=192.168.1.1, username=bryan.brandau, \
  level=info, priority=p3, view="profile parser", \
  message="The programmer did something bad"</code></pre>
</div>
</div><div class="slide" data-transition="growY"><div class="content bullets smaller" ref="tie/01_slide/1">
<h1>Tie it all together</h1>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="tie/01_slide/2">
<p><img src="./file/tie/../img/portal.png" alt="tie"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="tie/01_slide/3">
<h1>Dashboards</h1>

<ul>
<li>Roll your own with all the api's</li>
<li>Gdash</li>
<li>Graphene</li>
<li>Dashboard</li>
<li>Graphiti</li>
<li>Tasseo</li>
<li>many more (search github)</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="tie/01_slide/4">
<p><img src="./file/tie/../img/alerts.png" alt="tie"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="tie/01_slide/5">
<p><img src="./file/tie/../img/tvs.jpg" alt="graphite"/>
</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content center" ref="tie/01_slide/6">
<p><img src="./file/tie/../img/team.JPG" alt="graphite"/>
</p>
</div>
</div><div class="slide" data-transition="growY"><div class="content smaller" ref="close/01_slide/1">
<h1>Scale?</h1>
</div>
</div><div class="slide" data-transition="growY"><div class="content smaller" ref="close/01_slide/2">
<h1>What should you monitor</h1>

<ul>
<li>KPI/CBP</li>
<li>System Metrics are cheap to collect</li>
<li>Model/View/Controller timings</li>
<li>Bounds of your technologies (threads, request counts, JMX)</li>
<li>GC Events</li>
<li>Deployments/Change</li>
<li>Alerts</li>
</ul>
</div>
</div><div class="slide" data-transition="growY"><div class="content center" ref="close/01_slide/3">
<p><img src="./file/close/../img/map.png" alt="graphite"/>
</p>
</div>
</div><div class="slide" data-transition="growY"><div class="content small" ref="close/01_slide/4">
<h1>Other things to look at</h1>

<ul>
<li>Riemann</li>
<li>StatsD</li>
<li>Uptime</li>
<li>Information Dashboard Design (book)</li>
<li>Pager Duty</li>
<li>Watir</li>
<li>Selenium</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets smaller" ref="end/01_slide/1">
<h1>We're Hiring</h1>

<ul>
<li>devops, cloud operations, ops manager, monitoring</li>
<li>Work with these technologies and more like Chef, Riak, Cassandra, Solr, AWS, Rackspace, etc</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets small" ref="end/01_slide/2">
<h1>Contact</h1>

<h2>Twitter:</h2>

<p>@agent462</p>

<h2>Email:</h2>

<p>agent462@gmail.com</p>

<h2>Github:</h2>

<p>https://github.com/agent462</p>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content smaller" ref="end/02_slide/1">
<h1>Sensu</h1>

<ul>
<li>http://sensuapp.org/</li>
<li>https://github.com/sensu</li>
<li>https://github.com/sensu/sensu-community-plugins</li>
</ul>

<h1>Collectd</h1>

<ul>
<li>http://collectd.org/</li>
<li>http://git.verplant.org/?p=collectd.git;a=summary</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content smaller" ref="end/02_slide/2">
<h1>Graphite</h1>

<ul>
<li>http://graphite.readthedocs.org/en/0.9.10/index.html</li>
<li>https://github.com/graphite-project</li>
</ul>

<h1>Logstash</h1>

<ul>
<li>http://www.logstash.net/</li>
<li>https://github.com/logstash</li>
</ul>

<h1>Logster</h1>

<ul>
<li>https://github.com/etsy/logster</li>
</ul>
</div>
</div></div>
<div id="pauseScreen">
  
</div>

</body>
</html>
